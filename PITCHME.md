---
theme: gaia
_class: lead
paginate: true
backgroundColor: #fff
backgroundImage: url('https://marp.app/assets/hero-background.jpg')
marp: true
---

<!-- ![bg vertical 30%](https://d33wubrfki0l68.cloudfront.net/e7ed9fe4bafe46e275c807d63591f85f9ab246ba/e2d28/assets/images/tux.png) -->
# <!--fit--> **åŸºäºLinuxä¸ROSçš„æ— å•ç‰‡æœºç”µæ§**

å¹¿ä¸œå·¥ä¸šå¤§å­¦ DynamicX æœºå™¨äººé˜Ÿ é˜Ÿé•¿
å»–æ´½æº
liaoqiayuan@gmail.com

---

# ç›®å½•

- åŠ¨æœºã€èƒŒæ™¯ä¸ç›®æ ‡
- å®ç°
    - å®æ—¶æ€§
    - rm_base
    - rm_plugin
    - å¼€å‘æµç¨‹
- æ­¥å…µæœºå™¨äººå®ä¾‹
- Demo

---
# åŠ¨æœºã€èƒŒæ™¯ä¸ç›®æ ‡

<span style="color:gray;">
<font color=black>

- åŠ¨æœºã€èƒŒæ™¯ä¸ç›®æ ‡
</font>

- å®ç°
  - ç¡¬ä»¶æ–¹æ¡ˆ
  - è½¯ä»¶å †æ ˆ
  - å¼€å‘æµç¨‹
- æ­¥å…µæœºå™¨äººå®ä¾‹
- Demo

</span>

---
<!--
_header: '**åŠ¨æœº**'
-->

## ä¸¾æ‰‹âœ‹
<!-- ç›¸ä¿¡ç°åœ¨æœ‰ä¸å°‘ç”µæ§ç»„çš„æˆå‘˜ï¼Œä¸çŸ¥é“å¤§å®¶æœ‰æ²¡æœ‰é‡åˆ°è¿‡ç”µæ§å¼€å‘æ—¶çš„æ•ˆç‡ã€å…¼å®¹æ€§ç¨³å®šæ€§é—®é¢˜ï¼Œå¦‚æœæœ‰çš„è¯è¯·ä¸¾ä¸€ä¸‹æ‰‹å¯ä»¥å˜› -->

<!-- å¤§å®¶å¯ä»¥çœ‹åˆ°è¿™äº›é—®é¢˜æ˜¯æ™®éå­˜åœ¨çš„ï¼Œé‚£ä¹ˆæ€ä¹ˆè§£å†³è¿™äº›é—®é¢˜å‘¢ï¼Ÿ
è®©æˆ‘ä»¬çœ‹çœ‹è¿‘å¹´æ¥å…ˆè¿›çš„æœºå™¨äººçš„ç”µæ§æ–¹æ¡ˆæ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿ -->
æ›¾ç»è§‰å¾—...
- ä½¿ç”¨ keil å¼€å‘å¾ˆéš¾å—
- ç»å¸¸é‡å¤ç¼–å†™å’Œç»´æŠ¤åŠŸèƒ½ç±»ä¼¼çš„æœºå™¨äººä»£ç 
- ä¸ç®—æ³•ç»„ä¸Šä½æœºæ¥å£ä¸ç¨³å®š
- éš¾ä»¥ç§»æ¤å…¶ä»–å¹³å°çš„ç®—æ³•åº“
- å•ç‰‡æœºç®—åŠ›ä¸è¶³
- ç”µæ§ç³»ç»Ÿç»“æ„å¤æ‚

âœ‹âœ‹âœ‹âœ‹âœ‹âœ‹âœ‹âœ‹âœ‹âœ‹âœ‹âœ‹âœ‹âœ‹âœ‹âœ‹âœ‹âœ‹âœ‹âœ‹

---
<!--
_class: lead
_backgroundImage: 
_header: '**èƒŒæ™¯**'
-->
## ANYmal

- å¼€å‘äºï¼š2017å¹´
- æ€»çº¿ï¼š CAN / EtherCAT
- ä¸»æ§ï¼šIntel NUC

![width:250px](https://images-na.ssl-images-amazon.com/images/I/71lvXwuUHvL._AC_SL1500_.jpg)

![bg right:50% 90% drop-shadow](https://spectrum.ieee.org/image/MzMxMTYxMg.jpeg)


---
## <!--fit-->  MIT Cheetah 3/Mini
<!--
_class: lead
_backgroundImage: 
_header: '**èƒŒæ™¯**'
-->

- å¼€å‘äºï¼š2018å¹´
- æ€»çº¿ï¼š CAN
- ä¸»æ§ï¼šUPboard
  
![width:250px](https://m.media-amazon.com/images/I/51ENf1iayVL.jpg)

![bg right:50% 90% drop-shadow](https://i1.wp.com/www.intelligentliving.co/wp-content/uploads/2019/03/mini-cheetah.png?resize=1024%2C684&ssl=1)

---
## å¦™ç®—æ§è½¦
<!--
_class: lead
_backgroundImage: 
_header: '**èƒŒæ™¯**'
-->

- å¼€å‘äºï¼š2019å¹´é«˜ä¸­ç”Ÿå¤ä»¤è¥
- æ€»çº¿ï¼š CAN
- å…¨è‡ªåŠ¨
- ä¸»æ§ï¼šå¦™ç®—2

![width:250px](https://www1.djicdn.com/cms_uploads/ckeditor/pictures/2286/content_241ed6de92bb47d73cbd98ba23c33e74.jpg)

![bg right:50% 90% drop-shadow](./assets/2019summer.jpg)

---
<!--
_class: lead
_header: '**èƒŒæ™¯**'
-->
### æ¯”èµ›å…¨è‡ªåŠ¨è¿è¡Œè§†é¢‘ 

<video  src="./assets/IMG_0149.TRIM.MOV" controls width="100%">
</video>

---
<!--
_class: lead
_header: '**èƒŒæ™¯**'
-->
### <!--fit--> ğŸ”ª ç æ‰å•ç‰‡æœº
<!-- æ‰€ä»¥ï¼Œ è§£å†³æ–¹æ¡ˆæ˜¯ï¼ç æ‰å•ç‰‡æœºæ˜¯æŒ‡ï¼Œ ä½¿ç”¨PCä½œä¸ºä¸»æ§åˆ¶å™¨ï¼Œå•ç‰‡æœºåªè´Ÿè´£ç”µæœºFOCé©±åŠ¨ç­‰åº•å±‚é©±åŠ¨è®¾å¤‡ã€‚ -->

---
## ç›®æ ‡&ä¼˜åŠ¿
<span style="font-size:70%">

1. æå…¶ç®€å•çš„ç³»ç»Ÿç»“æ„
    - ä¸éœ€è¦ç¼–å†™å•ç‰‡æœºç¨‹åº
    - ä¸»æ§ä¸è§†è§‰è¯†åˆ«çš„è®¡ç®—è®¾å¤‡ç›¸åŒ
2. æé«˜å¼€å‘æ•ˆç‡
    - æ‰€æœ‰ç”µæœº, ä¼ æ„Ÿå™¨æ•°æ®å‡å¯è®°å½•å’Œå¯è§†åŒ–
    - æ‰€æœ‰æ§åˆ¶å‚æ•°å‡å¯åŠ¨æ€å’Œè¿œç¨‹è°ƒè¯•
    - ä¸°å¯Œçš„æˆç†Ÿè½¯ä»¶åŒ…
3. å…¼å®¹æ€§å¯å¤ç”¨æ€§å¼º
   - æä¾›ä¸‰å¥—ç¡¬ä»¶è§£å†³æ–¹æ¡ˆ
   - ç¨‹åºæ¨¡å—åŒ–, å¹¶é€šè¿‡ROS pluginsè¿›è¡ŒåŠ¨æ€åŠ è½½, æ‰€æœ‰æœºå™¨äººå…±ç”¨ä¸€å¥—ä»£ç 
   - æ”¯æŒ CAN æ€»çº¿, DBus, UART, GPIO, PWM ç­‰ RM å¸¸ç”¨å¤–è®¾
4. ç›¸æ¯”å•ç‰‡æœºè€Œè¨€, æé«˜çš„ç®—åŠ›

</span>

---
# å®ç°

<span style="color:gray;">

- åŠ¨æœºã€èƒŒæ™¯ä¸ç›®æ ‡
<font color=black>

- å®ç°
</font>

  - ç¡¬ä»¶æ–¹æ¡ˆ
  - å®æ—¶æ€§
  - è½¯ä»¶å †æ ˆ
  - å¼€å‘æµç¨‹
- æ­¥å…µæœºå™¨äººå®ä¾‹
- Demo

</span>

---
<!--
_header: '**å®ç°**'
-->
# ç¡¬ä»¶
æ ¹æ®è§†è§‰è¯†åˆ«è¦æ±‚ï¼š

<span style="font-size:70%">

1. Jetson ç³»åˆ—: æ·±åº¦å­¦ä¹ è§†è§‰ç®—æ³•
   - å†…ç½®CAN
   - å†…ç½®GPIO/SPI/iiC

2. Intel NUC: ä¼ ç»Ÿè§†è§‰ç®—æ³•

   - USBè½¬CAN (Candlelight)
   - CANè½¬GPIO

3. UP Board: æ— è§†è§‰ç®—æ³•

   - SPIè½¬CAN (MCP2515)
   - å†…ç½®GPIO

</span>

---
<!--
_header: '**å®ç°**'
-->
## å®æ—¶æ€§
<span style="font-size:70%">

- Linux + [PREEMPT_RT](https://rt.wiki.kernel.org/index.php/Main_Page) è¡¥ä¸
- UP Board åœ¨ å‹åŠ›ä¸‹çš„å®æ—¶æ€§æµ‹è¯•ï¼š

</span>


<!-- cyclisttest -->
<center>

![width:450px drop-shadow](./assets/rt0.png) ![width:450px drop-shadow](./assets/rt1.png)
</center>

---
<!--
_header: '**å®ç°**'
-->
## è½¯ä»¶å †æ ˆ

<span style="font-size:70%">
æ•´ä¸ªè½¯ä»¶ç”±å¤šä¸ªROS packageç»„æˆ, ä»–ä»¬è¿è¡Œäº Linux å’Œ ROS ä¸Šã€‚

1. é©±åŠ¨:
   - é€šè¿‡æè¿°æ–‡ä»¶å®šä¹‰æœºå™¨äººçš„ï¼šæ€»çº¿, æ‰§è¡Œå™¨, ä¼ æ„Ÿå™¨ç±»å‹å’Œå‚æ•°
   - è®¡ç®—ç”µæœºä½ç½®, é€Ÿåº¦ç­‰çŠ¶æ€ï¼Œä¼ æ„Ÿå™¨çš„æ•°æ®å¹¶æ ‡å‡†å•ä½åŒ–
   - è¿è¡ŒåŸºç¡€æ§åˆ¶å™¨ï¼ˆPID + Feedfowardï¼‰
   - å‘æ¨¡å—æä¾›æ•°æ®è®¿é—®æ¥å£

2. æ¨¡å—ï¼š
   - æ ¹æ®æœºæ¢°ç»“æ„æˆ–ç”µæ§é€»è¾‘å’ŒåŠŸèƒ½ï¼Œå¯¹æœºå™¨äººæ¨¡å—åŒ–
   - è¿è¡Œç®€å•çš„çŠ¶æ€æœºå’Œè¿åŠ¨å­¦ï¼ŒåŠ¨åŠ›å­¦ç®—æ³•ï¼Œè®¡ç®—åŸºç¡€æ§åˆ¶å™¨æœŸæœ›
   - æä¾› topicã€serverã€action çš„ROSæ¥å£
3. å†³ç­–ï¼š
   - æ ¹æ®é¥æ§å’Œè£åˆ¤ç³»ç»Ÿç­‰æ•°æ®å‘å„ä¸ªæ¨¡å—å‘é€æŒ‡ä»¤
  
</span>

---
<!--
_header: '**è½¯ä»¶å †æ ˆ**'
-->
### æ–‡ä»¶ç»“æ„

<center>

![width:800px drop-shadow](./assets/software.png)
</center>

---
<!--
_header: '**è½¯ä»¶å †æ ˆ**'
-->
### èŠ‚ç‚¹å›¾
<center>

![width:700px drop-shadow](./assets/node.png)

</center>

---
<!--
_header: '**å®ç°**'
-->
### ç ”å‘æµç¨‹
1. é˜Ÿé•¿ã€ç»„é•¿ä¸è´Ÿè´£äººç¡®å®šé¡¹ç›®éœ€æ±‚;
2. è´Ÿè´£äººå¼€æ–°branch;
3. é¡¹ç›®æˆå‘˜åœ¨branchè¿›è¡Œå¼€å‘;
4. å¯¹æ¯ä¸ªé‡è¦è¿›è¡Œcommit;
5. é¡¹ç›®æµ‹è¯•å’ŒéªŒæ”¶;
6. éªŒæ”¶åmergeåˆ°ä¸»åˆ†æ”¯ã€‚


---
<!--
_header: '**æ­¥å…µæœºå™¨äººå®ä¾‹**'
-->
# æ­¥å…µæœºå™¨äººå®ä¾‹

<span style="color:gray;">

- åŠ¨æœºã€èƒŒæ™¯ä¸ç›®æ ‡

- å®ç°

  - ç¡¬ä»¶æ–¹æ¡ˆ
  - å®æ—¶æ€§
  - è½¯ä»¶å †æ ˆ
  - å¼€å‘æµç¨‹
<font color=black>
- æ­¥å…µæœºå™¨äººå®ä¾‹
</font>
- Demo

</span>

---
<!--
_header: '**æ­¥å…µæœºå™¨äººå®ä¾‹**'
-->
## rm_base

<span style="font-size:70%">

```yaml
joint: 
[
   { name: "wheel_rf", bus: "can0", id: 0x201,
   type: "3508", ctrl: "speed" ,dir: false },
   { name: "wheel_lf", bus: "can0", id: 0x202,
   type: "3508", ctrl: "speed" ,dir: true },
   ....................çœç•¥ç”µæœº......................
   { name: "trigger", bus: "can1", id: 0x203,
   type: "2006", ctrl: "pd" ,dir: true }, 
]
imu:
   { type: "hi220", port: "/dev/usbImu", id: 0, rate: 200,
    frame_fixed: "base_link", frame_source: "odom", frame_target: "base_link" }

plugins:
  - chassis_plugins::Standard
  - gimbal_plugins::Standard
  - shooter_plugins::Standard
  - imu_plugins::Hi220Uart
  - track_plugins::KalmanFilterTrack

```

</span>



---
<!--
_header: '**æ­¥å…µæœºå™¨äººå®ä¾‹**'
-->
## äº‘å°æ¨¡å—

<span style="font-size:80%">

- åŠŸèƒ½:
  - è·Ÿè¸ªæ¨¡å¼: æŒ‡å‘æœŸæœ›è§’åº¦(æªç®¡å§¿æ€)
  - æ‰‹æ“æ¨¡å¼: ä»¥ç‰¹å®šè§’é€Ÿåº¦æ—‹è½¬
- ç‰¹æ€§:
  - IMUå¯ä»¥è£…åœ¨è½¦ä½“ä»»ä½•ä½ç½®
  - åœ¨è½¦ä½“ä»»æ„è§’åº¦å€¾æ–œæ—¶ä¿è¯æªç®¡å§¿æ€ä¸å˜ (å¿½ç•¥rollè½´æ—‹è½¬)
- æ¥å£ (topic: /cmd_gimbal):
  - æ¨¡å¼é€‰æ‹©
  - æœŸæœ›æŠ¢ç®¡é€Ÿåº¦
  - æœŸæœ›æŠ¢ç®¡å§¿æ€

</span>

---
<!--
_header: '**æ­¥å…µæœºå™¨äººå®ä¾‹**'
-->
## è·Ÿè¸ªæ¨¡å—
![bg right:60% 90% drop-shadow](./assets/track.png)

<span style="font-size:65%">

åŠŸèƒ½:
  - ä¼°è®¡è£…ç”²æ¿ä½ç½®
  - é¢„æµ‹è£…ç”²æ¿ä½ç½®
  
ç‰¹æ€§:
  - è€ƒè™‘äº‘å°è½¬åŠ¨é€Ÿåº¦
  - è€ƒè™‘è‡ªèº«è½¦ä½“é€Ÿåº¦
  
æ¥å£:
  - å°†é¢„æµ‹å€¼ç»™ï¼š 
    - äº‘å°æ¨¡å— (blackboard)
    - è§†è§‰ Node (topic)

</span>

---
# Demo

<span style="color:gray;">

- åŠ¨æœºã€èƒŒæ™¯ä¸ç›®æ ‡

- å®ç°

  - ç¡¬ä»¶æ–¹æ¡ˆ
  - å®æ—¶æ€§
  - è½¯ä»¶å †æ ˆ
  - å¼€å‘æµç¨‹
- æ­¥å…µæœºå™¨äººå®ä¾‹
<font color=black>
- Demo
</font>

</span>

---
<!--
_header: '**Demo**'
-->
## åº•ç›˜
<video  src="./assets/chassis.mp4" controls width="100%">
</video>

---
<!--
_header: '**Demo**'
-->
## äº‘å°
<video  src="./assets/gimbal.mp4" controls width="100%">
</video>

---
<!--
_header: '**Demo**'
-->
## 5hzå°„å‡»
<video  src="./assets/shooter5hz.mp4" controls width="100%">
</video>

---
<!--
_header: '**Demo**'
-->
## 20hzå°„å‡»
<video  src="./assets/shooter20hz.mp4" controls width="100%">
</video>


---
<!--
_header: '**Demo**'
-->
## è‡ªåŠ¨é£å¡
<video  src="./assets/fly.mp4" controls width="100%">
</video>


---
# RoadMap


<span style="font-size:200%">

- åŸºäº ros_control é‡å†™
- æ›´å¤šçš„ç¨³å®šæ€§æµ‹è¯•
- å¼€æºâ¤ï¸

</span>


---
# é—®ç­”

## <!--fit--> â“

![bg 40%](https://upload.wikimedia.org/wikipedia/commons/thumb/3/35/Tux.svg/1200px-Tux.svg.png) 
